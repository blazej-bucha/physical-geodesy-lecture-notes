% =============================================================================
%
% This is the LaTeX source code of the lecture notes.
%
%
% Author:   Blazej Bucha
% Year:     2022
% Contact:  blazej.bucha@stuba.sk
% Encoding: UTF-8
%
% =============================================================================






% LaTeX Packages
% =============================================================================

\documentclass[a4paper, 12pt]{book}
\usepackage[slovak]{babel}
\usepackage[utf8]{inputenc}
\usepackage[round]{natbib}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{accsupp}
\usepackage[top=2.5cm, bottom=2.5cm, left=2.5cm, right=2.5cm]{geometry}
\linespread{1.2}

% =============================================================================






% Define and set the style of code listings
% =============================================================================

% Define custom colours
\definecolor{comments}{rgb}{0.65, 0.65, 0.65}
\definecolor{strings}{rgb}{0.0, 0.3, 0.7}
\definecolor{linenumbers}{rgb}{0.5, 0.5, 0.5}
\definecolor{keywords}{rgb}{0.85, 0.0, 0.0}
\definecolor{backcolour}{rgb}{0.98, 0.98, 0.98}


% Define custom listing style
\lstdefinestyle{codestyle}
{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{comments},
    keywordstyle=\color{keywords},
    numberstyle=\tiny\noncopynumber,
    columns=flexible,
    stringstyle=\color{strings},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2
}


% Defines a new command that ensures we can copy the source code from the 
% compiled PDF without copying the line numbers
\newcommand{\noncopynumber}[1]
{
    \BeginAccSupp{method=escape,ActualText={}}
    #1
    \EndAccSupp{}
}


% Apply the custom listing style
\lstset{style=codestyle}


% It seems the "listings" package is not able to encode the nice special Slovak 
% characters such as "á", "ľ", etc.  Next follows a brute force solution.
\lstset{
  literate={á}{{\'a}}1
           {ä}{{\" a}}1
           {č}{{\v c}}1
           {ď}{{d\kern-0.07cm\char39\kern-0.07cm}}1
           {é}{{\'e}}1
           {í}{{\'i}}1
           {ĺ}{{\'l}}1
           {ľ}{{l\kern-0.12cm\char39\kern-0.05cm}}1
           {ň}{{\v n}}1
           {ó}{{\'o}}1
           {ô}{{\^o}}1
           {ŕ}{{\'r}}1
           {š}{{\v s}}1
           {ť}{{t\kern-0.10cm\char39\kern-0.05cm}}1
           {ú}{{\'u}}1
           {ý}{{\'y}}1
           {ž}{{\v z}}1
           {Á}{{\'A}}1
           {Ä}{{\" A}}1
           {Č}{{\v C}}1
           {Ď}{{\v D}}1
           {É}{{\'E}}1
           {Í}{{\'I}}1
           {Ĺ}{{\'L}}1
           {Ľ}{{L\kern-0.12cm\char39\kern-0.00cm}}1
           {Ň}{{\v N}}1
           {Ó}{{\'O}}1
           {Ô}{{\^O}}1
           {Ŕ}{{\'R}}1
           {Š}{{\v S}}1
           {Ť}{{\v T}}1
           {Ú}{{\'U}}1
           {Ý}{{\'Y}}1
           {Ž}{{\v Z}}1
}


% Add the "as" keyword to the Python listings
\lstdefinelanguage{mypython}[]{Python}{morekeywords={as,True,False}}


% Caption title for listings
\renewcommand\lstlistingname{Zdrojový kód}

% =============================================================================






% Custom commands
% =============================================================================
\newcommand{\diff}{\mathrm d}
\let\vec\mathbf
% =============================================================================






% =============================================================================

\sloppy
\begin{document}

% -----------------------------------------------------------------------------
\tableofcontents
\newpage
% -----------------------------------------------------------------------------






% -----------------------------------------------------------------------------

\chapter*{Úvod}






% -----------------------------------------------------------------------------

\chapter{Fyzikálna geodézia}

Tvar Zeme možno definovať niekoľkými spôsobmi v závislosti od kontextu 
\citep{MoritzTheFigureOfTheEarth}.  Azda najprirodzenejšie je definovať tvar 
Zeme jej skutočným fyzickým povrchom, teda tou časťou Zeme, ktorá je viditeľná 
voľným okom.  Takýto povrch by však obsahoval aj nespočetné množstvo zložitých 
terénnych útvarov, napríklad náhle skokovité zmeny terénu.  Hoci sú takéto 
oblasti krásne na pohľad, znemožňujú aplikovať časť potrebného matematického 
aparátu, napríklad plošnú integráciu.  Skúmať takto chápaný zemský povrch je 
preto možné až po istom vyhladení.  Napriek tomu, ide o veľmi komplexnú plochu.

Pri definovaní tvaru Zeme však môžeme vziať v úvahu skutočnosť, že približne 
dve tretiny zemského povrchu tvorí voda v podobe oceánov a morí.  Ak by sme 
s podobnou mierou hladkosti dokázali predĺžiť povrch oceánov a morí aj popod, 
resp. ponad pevnú časť zemského povrchu, získali by sme v porovnaní s fyzickým 
povrchom Zeme značne jednoduchší a hladší, no pritom stále verný tvar Zeme.  
Voda má za istých okolností navyše tú výhodnú vlastnosť, že existuje fyzikálna 
veličina, ktorá je na jej povrchu konštantná.  Táto vlastnosť by teda následne 
mohla umožniť akúsi predikciu morskej hladiny aj popod, resp. ponad kontinenty.  
Inými slovami, v tejto definícií tvaru Zeme by išlo o geometricky jednoduchšiu 
plochu, navyše tentokrát už aj s istými relatívne jednoducho popísateľnými 
fyzikálnymi vlastnosťami.  Takto definovaný tvar Zeme bol navrhnutý 
C. F. Gaussom (1777--1855) a podľa návrhu J. B. Listinga (1808--1882) ho 
nazývame \emph{geoid}.  Veličina, ktorá je konštantná na povrchu geoidu sa 
nazýva \emph{tiažový potenciál}.

\emph{Fyzikálna geodézia} je vedná disciplína zaoberajúca sa určovaním tvaru 
Zeme, jej tiažovým poľom a ich zmenami v čase.  Študované sú oba vyššie opísané 
prístupy k tvaru Zeme, pričom historicky bol predmetom záujmu ako prvý geoid.  
Hoci prirodzená, no matematicky odvážna myšlienka určovať priamo fyzický povrch 
Zeme pochádza už od E. H. Brunsa (1848--1919), do popredia záujmu ju dostal až 
v polovici 20. storočia M. S. Molodenskij (1909--1991).  Dôležitá je však 
skutočnosť, že i v tomto prípade je tvar Zeme určovaný z informácie o tiažovom 
poli.  Študovať tvar Zeme, čo je jedna zo základných úloh geodézie, teda 
znamená študovať aj tiažové pole Zeme.

\section{Newtonov integrál}

%Uvažujme hmotný bod o hmotnosti $m$.  V zmysle gravitačného zákona 
%formulovaného I. Newtonom (1642--1727) tento hmotný bod generuje gravitačný 
%potenciál $V$.  Vo vzdialenosti $l$ od tohto hmotného je gravitačný potenciál 
%daný vzťahom
%%
%\begin{equation}
%V = G \frac{m}{l}{,}
%\end{equation}
%%
%kde $G = 6.6742 \times 10^{-11} \ \mathrm{m}^3 \ \mathrm{kg}^{-1} 
%\ \mathrm{s}^{-2}$ je Newtonova gravitačná konštanta.

Dva hmotné body $P$ a $Q$ nachádzajúce sa od seba vo vzájomnej vzdialenosti $l$ 
sa navzájom priťahujú \emph{gravitačnou silou}
%
\begin{equation}
\label{eq:gravity_law}
\vec{F} = -G \frac{m_P \, m_Q}{l^2} \, \frac{\vec{l}}{l}{.}
\end{equation}
%
Symbol $G$ označuje gravitačnú konštantu, $m_P$ a $m_Q$ predstavujú hmotnosti 
hmotných bodov a $\vec l$ je vektor medzi $P$ a $Q$ so začiatkom v~bode $Q$.  
Záporné znamienko v rovnici znamená, že vektor sily $\vec F$ má začiatok v bode 
$P$ a smeruje do bodu $Q$, teda hmotný bod $P$ je priťahovaný hmotným bodom 
$Q$.

Rovnica~(\ref{eq:gravity_law}) predstavuje \emph{gravitačný zákon} formulovaný 
I. Newtonom (1642--1727).  Hovorí, že ľubovoľné dva hmotné body vo vesmíre sú 
vzájomne priťahované silou, ktorej veľkosť je priamo úmerná súčinu ich 
hmotností a nepriamo úmerná štvorcu ich vzájomnej vzdialenosti.  Hmotný bod je 
idealizovaný pojem predstavujúci časticu s nulovým rozmerom a konečnou 
hmotnosťou (teda nekonečnou hustotou).  Rovnicu~(\ref{eq:gravity_law}) možno 
s rozumnou mierou aproximácie aplikovať napr. na popis pohybu planét Slnečnej 
sústavy.  Rozmery týchto telies sú totiž natoľko zanedbateľné v porovnaní s ich 
vzájomnou vzdialenosťou, že sa nedopustíme nerozumne veľkej chyby, ak ich 
budeme považovať za hmotné body a aplikujeme na ne Newtonov gravitačný zákon.

Rovnica~(\ref{eq:gravity_law}) závisí od hmotnosti oboch hmotných bodov, čo 
komplikuje skúmanie gravitačného poľa v ich okolí.  Skúsme preto normovať 
veľkosť gravitačnej sily hmotnosťou hmotného bodu $P$,
%
\begin{equation}
\frac{\vec F}{m_P}{,}
\end{equation}
%
prípadne uvažujme, že $m_P = 1\ \mathrm{kg}$.  Oba spôsoby vedú ekvivalentne 
k veličine, ktorá sa nazýva \emph{gravitačné zrýchlenie},
%
\begin{equation}
\label{eq:gravitational_vector}
\vec g_g = -G \frac{m}{l^2} \, \frac{\vec l}{l}{,}
\end{equation}
%
pričom $m = m_Q$.  Vektor gravitačného zrýchlenia má teda začiatok v bode $P$ 
a smeruje do bodu $Q$, o ktorom hovoríme, že generuje vektor gravitačného 
zrýchlenia v bode $P$.  Vektor gravitačného zrýchlenia veľmi úzko súvisí 
s veličinou, ktorú je možné odmerať na povrchu Zeme, a tak má kľúčový význam 
v procese určovania tvaru Zeme.

Ak by sme chceli v bode $P$ vypočítať gravitačné zrýchlenie generované $N$ 
hmotnými bodmi, vektorovo sčítame jednotlivé vektory gravitačného zrýchlenia, 
teda
%
\begin{equation}
\vec g_g = \sum_{i = 0}^{N}\vec g_i = -G \sum_{i = 0}^{N} \frac{m_i}{l_i^2} \, 
\frac{\vec l_i}{l_i}{.}
\end{equation}

Newtonov gravitačný zákon formulovaný vyššie uvedeným spôsobom platí spolu 
s následne získaným gravitačným zrýchlením iba pre hmotné body.  Zaujímavosti 
sa začnú diať, keď sa pokúsime o výpočet gravitačného zrýchlenia generovaného 
nie $N$ hmotnými bodmi, ale telesom konečných rozmerov s hoci premenlivou, no 
konečnou hustotou.

%
\begin{equation}
\label{eq:newton}
V(P) = G \iiint_{\tau} \frac{\rho(Q)}{l(P, Q)} \diff \tau(Q){,}
\end{equation}
%
následne hľadať veličiny, ktoré sú s ním spojené a je možné ich odmerať, 
a nakoniec zo získaných meraní vypočítať tvar Zeme v zmysle zvolenej definície.

\begin{figure}[bt]
\centering
\includegraphics{../figs/gravitating-body/gravitating-body.pdf}
\caption{Teleso generujúce gravitačný potenciál a výpočtový bod $P$}
\end{figure}

%Dva hmotné body s hmotnosťami $M_P$ a $M_Q$ sa priťahujú silou o veľkosti
%%
%\begin{equation}
%F = G \frac{M_P \, M_Q}{l_{PQ}}{,}
%\end{equation}
%%
%kde $l_{PQ}$ je vzdialenosť medzi hmotnými bodmi.  Gravitačná sila pôsobí 
%v smere spojnice hmotných bodov $P$ a $Q$.
Vo vzťahu (\ref{eq:newton}) predstavuje symbol $V$ gravitačný potenciál v bode 
$P$ generovaný telesom s objemom $\tau$ a hustotou $\rho(P')$, ktorá môže 
závisieť od polohy integračného elementu $\diff \tau(P')$ vo vnútri telesa.  
Symbolom $l$ budeme označovať Euklidovskú vzdialenosť, v tomto prípade medzi 
výpočtovým bodom $P$ a integračným elementom $\diff \tau(P')$ vo vnútri telesa, 
ktoré generuje gravitačne pole.

\subsection{Tak počkať\ldots  A čo teória relativity, či teórie $A$, $B$, $C$, 
\ldots?}







\section{Súradnicový systém}

\begin{figure}[bt]
\centering
\includegraphics{../figs/coordinate-systems/cart-sph.pdf}
\caption{Pravouhlé a~sférické súradnice}
\end{figure}


\section{Polia}

\section{Operátory poľa}

% čo to je?
% súradnicový systém?
% polia
% skalár, vektor, tenzor + ukážky + kódy
% gradient, divergencia, rotácia
% Newtonov gravitačný zákon + pár slov k teórii relativity


\lstinputlisting[caption=Výpočet a~zobrazenie funkcie a~jej gradientu v~gride, 
language=mypython]{../python/f-gradf.py}

\begin{figure}[bt]
\centering
\includegraphics{../figs/f-gradf.pdf}
\caption{Funkcia $f(x, y) = \sin(2x) + \cos(2y)$ a~jej gradient $\nabla f(x, 
y)$ na~intervale $x, y \in [-1, 1]$}
\end{figure}






% -----------------------------------------------------------------------------

\chapter{Gravitačné a tiažové pole homogénnej gule}

% polia, označenia, jednotky





% -----------------------------------------------------------------------------

\chapter{Gravitačný potenciál všeobecného telesa}

% rozvoj potenciálu do radu sférických harmonických funkcií






% -----------------------------------------------------------------------------

\chapter{Sférické harmonické funkcie}

% čo to je, definícia, porovnanie s jednotkovými vektormi, delenie, ukážka 
% sférických harmonických funkcií v matematickom zápise + obrázky + kód, 
% normovanie, Legendreove polynómy + funkcie, definícia, grafy + kód

\lstinputlisting[caption=Výpočet a~zobrazenie Legendreových polynómov, 
language=mypython]{../python/legendre-polynomials.py}

\begin{figure}[bt]
\centering
\includegraphics{../figs/legendre-polynomials.pdf}
\caption{Legendreove polynómy}
\end{figure}


\lstinputlisting[caption=Výpočet a~zobrazenie nenormovaných sférických 
harmonických funkcií, language=mypython]{../python/spherical-harmonics.py}

\begin{figure}[bt]
\centering
\includegraphics{../figs/spherical-harmonic-n3-m0.pdf}
\includegraphics{../figs/spherical-harmonic-n3-m1.pdf}
\includegraphics{../figs/spherical-harmonic-n3-m3.pdf}
\includegraphics{../figs/spherical-harmonic-n4-m0.pdf}
\includegraphics{../figs/spherical-harmonic-n4-m1.pdf}
\includegraphics{../figs/spherical-harmonic-n4-m4.pdf}
\caption{Nenormované plošné sférické harmonické funkcie.  Záporné hodnoty sú 
zobrazené odtieňmi modrej farby, kladné hodnoty odtieňmi červenej farby.  
\textit{Vrchný rad} (zľava): $Y_{3,0}(\varphi, \lambda)$, $Y_{3,1}(\varphi, 
\lambda)$, $Y_{3,3}(\varphi, \lambda)$.  \textit{Spodný rad} (zľava): 
$Y_{4,0}(\varphi, \lambda)$, $Y_{4,1}(\varphi, \lambda)$, $Y_{4,4}(\varphi, 
\lambda)$}
\label{fig:sh}
\end{figure}


\begin{figure}[bt]
\centering
\includegraphics{../figs/spherical-harmonic-n3-m0-3d.pdf}
\includegraphics{../figs/spherical-harmonic-n3-m1-3d.pdf}
\includegraphics{../figs/spherical-harmonic-n3-m3-3d.pdf}
\includegraphics{../figs/spherical-harmonic-n4-m0-3d.pdf}
\includegraphics{../figs/spherical-harmonic-n4-m1-3d.pdf}
\includegraphics{../figs/spherical-harmonic-n4-m4-3d.pdf}
\caption{Nenormované plošné sférické harmonické funkcie z Obr.~\ref{fig:sh} 
zobrazené ako odľahlosť nadobúdanej hodnoty od jednotkovej sféry}
\label{fig:sh3d}
\end{figure}





% -----------------------------------------------------------------------------

\section{Elipsoidické harmonické funkcie}

% čo to je, definícia, obrázky + grafy + kód, využitie






% -----------------------------------------------------------------------------

\chapter{Normálne tiažové pole}

% čo to je, prečo sa zavádza, ekvipotenciálny elipsoid, základné a odvodené 
% parametre elipsoidu, geometrické a fyzikálne parametre, základné veličiny, 
% stručne opísať normálne pole pomocou elipsoidických harmonických funkcií 
% a vysvetliť výhody takéhoto opisu (uzavreté vzťahy), somiglianov vzťah






% -----------------------------------------------------------------------------

\chapter{Poruchové pole}

% čo to je, prečo sa zavádza, využitie, základné veličiny, vzťahy medzi nimi






% -----------------------------------------------------------------------------

\chapter{Výpočet geoidu}






% -----------------------------------------------------------------------------

\section{Výpočet geoidu rozvojom do radu sférických harmonických funkcií}






% -----------------------------------------------------------------------------

\section{Výpočet geoidu astronomicko--geodetickou niveláciou}






% -----------------------------------------------------------------------------

\section{Výpočet geoidu numerickou integráciou Stokesovho a Hotine integrálov}






% -----------------------------------------------------------------------------

\chapter*{Záver}






% Bibliography
% -----------------------------------------------------------------------------

\bibliographystyle{apalike}
\bibliography{references.bib}

\end{document}

% =============================================================================
% End of the code

